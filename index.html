<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>马 又</title>
  <meta name="author" content="dongc">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="马 又"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/favicon.png" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/readable.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">马 又</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives/" title="Archives">
			  <i class=""></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/douban/" title="books">
			  <i class=""></i>Books
			</a>
		  </li>
		  
		  <li>
			<a href="/about/" title="About me.">
			  <i class=""></i>About me
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 <div class="page-header page-header-inverse ">
  <h1 class="title title-inverse ">正襟危坐一码农</h1>
</div>

<div class="row page">

	
	<div class="col-md-9" style="width:100%">
	

		<div id="top_search"></div>
		<div class="mypage">
		
		<!-- title and entry -->
        <!-- render top articles firstly -->
        
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
            
		
        
        <!-- render other articles -->
        
           
           <div class="post">
			  
	
	<!-- display as entry -->	
	<a href="/2018/03/20/20180320/"  style="text-decoration:none">
		<h3 class="title">
			<div class="article-title" style="color:#4C4C4C">Java Collection(一)：Array-based Data Structure</div>
		</h3>
		</a>
	


			  <div class="entry" style="padding-right:12px;">
  <div class="row">
	
	
		<h3 id="Brief"><a href="#Brief" class="headerlink" title="Brief"></a>Brief</h3><p>底层数据结构基于数组的集合，可以通过“下标”快速定位到指定元素；数组的增、删元素时需要进行数据移动拷贝；数据扩容时，需要进行<code>Arrays.copyOf()</code>。</p>
<h3 id="Basic-Opertions"><a href="#Basic-Opertions" class="headerlink" title="Basic Opertions"></a>Basic Opertions</h3><p><strong>Indexing:</strong></p>
<ul>
<li>An obvious choice for implementing the list ADT is to use an array, <code>A</code>, where <code>A[i]</code> stores (a reference to) the element with index i. </li>
<li>With a representation based on an array <code>A</code>, the <code>get(i)</code> and <code>set(i, e)</code> methods are easy to implement by accessing <code>A[i]</code> (assuming i is a legitimate index).</li>
</ul>
<p><img src="http://odwh5mzb8.bkt.clouddn.com/blog_08320-1.png" alt="Indexing"></p>
<p><strong>Insertion:</strong></p>
<ul>
<li>In an operation <code>add(i, o)</code>, we need to make room for the new element by shifting forward the <code>n - i</code> elements <code>A[i], …, A[n - 1]</code></li>
<li>In the worst case (<code>i = 0</code>), this takes <code>O(n)</code> time</li>
</ul>
<p>In an <code>add</code> operation, when the array is full, instead of throwing an exception, we can replace the array with a larger one.</p>
<p><img src="http://odwh5mzb8.bkt.clouddn.com/blog_08320-2.png" alt="Indexing"></p>
<p><strong>Removal:</strong></p>
<ul>
<li>In an operation <code>remove(i)</code>, we need to fill the hole left by the removed element by shifting backward the <code>n - i - 1</code> elements <code>A[i + 1], …, A[n - 1]</code></li>
<li>In the worst case (<code>i = 0</code>), this takes <code>O(n)</code> time</li>
</ul>
<h3 id="Categories"><a href="#Categories" class="headerlink" title="Categories"></a>Categories</h3><ul>
<li><strong>Fixed-Array</strong> : Array</li>
<li><strong>Resizable-Array</strong>:  ArrayList, Vector(<code>thread-safe</code>)</li>
<li><strong>Immutable-Array</strong>:  ImmutableList(<code>Google Guaua</code>) </li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">Collection</th>
<th style="text-align:right">thread-safe</th>
<th style="text-align:center">grow rule</th>
<th style="text-align:center">init size</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">ArrayList</td>
<td style="text-align:right"><code>not</code></td>
<td style="text-align:center">50% of its size</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:left">Vector</td>
<td style="text-align:right"><code>yes</code></td>
<td style="text-align:center">doubles its array size</td>
<td style="text-align:center">10</td>
</tr>
<tr>
<td style="text-align:left">ImmutableList</td>
<td style="text-align:right"><code>yes</code></td>
<td style="text-align:center">no</td>
</tr>
</tbody>
</table>
<p> 通过<code>Collections.synchronizedCollection()</code>可以将ArrayList转换为线程安全的List。</p>
<h3 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h3><p>In an array-based implementation of a dynamic list:</p>
<ul>
<li>The space used by the data structure is <code>O(n)</code></li>
<li>Indexing the element at i takes <code>O(1)</code> time</li>
<li>add and remove run in <code>O(n)</code> time in the worst case</li>
</ul>
<h3 id="Appendix"><a href="#Appendix" class="headerlink" title="Appendix"></a>Appendix</h3><ul>
<li><code>System.arraycopy()</code> VS <code>Arrays.copyOf()</code>: The difference is that <code>Arrays.copyOf</code> does not only copy elements, it also creates a new array. <code>System.arrayCopy</code> copies into an existing array. </li>
<li>为什么concurrent包下没有ArrayList的实现？</li>
</ul>

	
	</div>
</div>

			  </div>
           
		
           
           <div class="post">
			  
	
	<!-- display as entry -->	
	<a href="/2017/08/04/20170804/"  style="text-decoration:none">
		<h3 class="title">
			<div class="article-title" style="color:#4C4C4C">MySQL索引(一)：正确、有效地使用索引</div>
		</h3>
		</a>
	


			  <div class="entry" style="padding-right:12px;">
  <div class="row">
	
	
		<h1 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h1><ol>
<li>什么是索引？</li>
<li>索引分类</li>
<li>创建原则</li>
<li>使用注意</li>
<li>案例</li>
</ol>
<h3 id="什么是索引？"><a href="#什么是索引？" class="headerlink" title="什么是索引？"></a>什么是索引？</h3><p>MySQL官方定义：“<strong>Index (索引)</strong>”是帮助MySQL高效获取数据的数据结构。“<strong>Index (索引)</strong>”本质是一种数据结构，存储在磁盘上。MySQL普遍使用<code>B+Tree</code>作为索引结构。</p>
<p><strong>Linear Searh</strong>: 
<a href="http://odwh5mzb8.bkt.clouddn.com/-linear_search.gif" target="_blank" rel="external"><img src="http://odwh5mzb8.bkt.clouddn.com/-linear_search.gif" alt="tcp_keepalive"></a></p>
<p><strong>B+Tree Search</strong>:
<a href="http://odwh5mzb8.bkt.clouddn.com/binary-search-tree-sorted-array-animation.gif" target="_blank" rel="external"><img src="http://odwh5mzb8.bkt.clouddn.com/binary-search-tree-sorted-array-animation.gif" alt="tcp_keepalive"></a></p>
<h3 id="索引分类"><a href="#索引分类" class="headerlink" title="索引分类"></a>索引分类</h3><p>按照索引列的值必须唯一：</p>
<ul>
<li><strong>普通索引</strong> ：允许索引列中插入重复值和空值</li>
<li><strong>唯一索引</strong> ：索引列的值必须唯一，但允许为空值。主键索引是一种特殊的唯一索引，不允许有空值。</li>
</ul>
<p>按照索引列组成的个数：</p>
<ul>
<li><strong>单列索引</strong>：索引只包含单个列，一个表可以有多个单列索引。</li>
<li><strong>组合索引</strong>：多个字段组合，创建的索引。遵循“<strong>最左前缀原则</strong>”</li>
</ul>
<p>其他索引：</p>
<ul>
<li><strong>全文索引（FULLTEXT）</strong>：在定义索引列上支持值得全文查找。</li>
</ul>
<h3 id="创建原则"><a href="#创建原则" class="headerlink" title="创建原则"></a>创建原则</h3><ol>
<li>2000条以上建议建索引</li>
<li>组合索引：最左前缀原则，“选择性”高的列排在前面。</li>
<li>“选择性”低的列不建议建立索引。<code>Index Selectivity = Cardinality / #T </code></li>
<li>尽量地扩展原有索引，不建议新建索引</li>
<li>字符串尽量使用短索引</li>
</ol>
<h3 id="使用注意"><a href="#使用注意" class="headerlink" title="使用注意"></a>使用注意</h3><ol>
<li>隐式类型转换，无法命中索引，扫描全表（<code>建议按照字段类型传值</code>）。</li>
<li>参与计算（<code>函数和表达式</code>）的列，不走索引。</li>
<li>“负向查询”不走索引。</li>
<li>前导模糊查询不能走索引。如：<code> like ‘%xxx’</code></li>
</ol>
		<!-- only display read_more button if there's more to display -->
		<a type="button" style="font-size:15px" href="/2017/08/04/20170804/#more" class="more">Read More...</a>
	
	</div>
</div>

			  </div>
           
		
           
           <div class="post">
			  
	
	<!-- display as entry -->	
	<a href="/2016/12/08/1400/"  style="text-decoration:none">
		<h3 class="title">
			<div class="article-title" style="color:#4C4C4C">Key In Http Protocol (二)：&#39;Connection&#39;</div>
		</h3>
		</a>
	


			  <div class="entry" style="padding-right:12px;">
  <div class="row">
	
	
		<h3 id="Brief"><a href="#Brief" class="headerlink" title="Brief"></a>Brief</h3><p>HTTP works with <strong>request-response</strong>: client connects to server, performs a request and gets a response. Normally, the connection to an HTTP server is closed after each response. With HTTP keep-alive you keep the underlying TCP connection open until “certain criteria” are met.</p>
<p><strong>“Connection:keep-alive”</strong> is a method to allow the same tcp connection for HTTP conversation instead of opening a new one with each new request. </p>
<p>More simply put, it is a communication between the web server and the web browser that says “<strong>you can grab more than just one file at a time</strong>“. Interaction diagram as follows:</p>
<p><a href="http://odwh5mzb8.bkt.clouddn.com/tcp_keepalive.png" target="_blank" rel="external"><img src="http://odwh5mzb8.bkt.clouddn.com/tcp_keepalive.png" alt="tcp_keepalive"></a></p>
<p>That enable HTTP ‘keep-alive’ is callded ‘<strong>HTTP persistent connection</strong>‘. See HTTP persistent connection for some advantages , such as:  </p>
<ul>
<li><strong>Lower CPU and memory usage</strong> : by opening and closing fewer TCP connections, CPU time is saved in routers and hosts (clients, servers, proxies, gateways, tunnels, or caches), and memory used for TCB (TCP control blocks) can be saved in hosts.</li>
<li><strong>Reduced latency</strong> : latency on subsequent requests is reduced since there is no time spent in TCP’s connection opening handshake.</li>
<li><strong>HTTP pipelining</strong> : HTTP requests and responses can be pipelined on a connection. Pipelining allows a client to make multiple requests without waiting for each response, allowing a single TCP connection to be used much more efficiently, with much lower elapsed time.</li>
</ul>
		<!-- only display read_more button if there's more to display -->
		<a type="button" style="font-size:15px" href="/2016/12/08/1400/#more" class="more">Read More...</a>
	
	</div>
</div>

			  </div>
           
		

		</div>

		<!-- pagination -->
		<div>
  		<center>
		<div class="pagination">
<ul class="pagination">
	 
		
          <li class="prev disabled"><a><i class="fa fa-arrow-circle-o-left"></i>Prev</a></li>
        

        <li><a href="/"><i class="fa fa-home"></i>Home</a></li>

		
		   <li class="next"> <a href="/page/2/" class="alignright next">Next<i class="fa fa-arrow-circle-o-right"></i></a> </li>          
        
	
</ul>
</div>

  		</center>
		</div>

		
		
	</div> <!-- col-md-9 -->


	
</div> <!-- row-fluid -->


	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  &copy; 2018 dongc
  
      with help from <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="http://getbootstrap.com/" target="_blank">Twitter Bootstrap</a>. Theme by <a href="http://github.com/wzpan/hexo-theme-freemind/">Freemind</a>.    
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>▲</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>





</body>
   </html>
